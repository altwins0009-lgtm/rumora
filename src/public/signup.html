<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up | Rumora</title>
    <!-- Use Clerk from YOUR custom domain -->
    <script src="https://clerk.rumora.frii.site/npm/@clerk/clerk-js@4/dist/clerk.browser.js"></script>
    <style>
        /* Your existing styles */
        body {
            margin: 0;
            padding: 40px;
            background: #0f0b1f;
            color: white;
            font-family: sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            width: 100%;
            max-width: 500px;
            text-align: center;
        }
        /* ... rest of your styles ... */
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">‚ú®</div>
        <h1>Join Rumora</h1>
        <p>Create your account to access magical features</p>
        
        <div id="clerk-container">
            Loading Clerk authentication...
        </div>
        
        <div class="status" id="status">
            Initializing...
        </div>
    </div>

    <script>
        // === YOUR CONFIGURATION ===
        const CLERK_PUBLISHABLE_KEY = 'pk_live_Y2xlcmsucnVtb3JhLmZyaWkuc2l0ZSQ';
        const CLERK_FRONTEND_API = 'https://clerk.rumora.frii.site';
        
        const statusEl = document.getElementById('status');
        
        function updateStatus(message, type = 'info') {
            const color = type === 'error' ? '#ef4444' : type === 'success' ? '#4ade80' : '#eab308';
            statusEl.innerHTML = `<span style="color: ${color}">${message}</span>`;
            console.log('Status:', message);
        }
        
        // Wait for Clerk to load
        function waitForClerk() {
            updateStatus('Waiting for Clerk SDK...');
            
            let attempts = 0;
            const maxAttempts = 20;
            
            const interval = setInterval(() => {
                attempts++;
                
                if (window.Clerk) {
                    clearInterval(interval);
                    initializeClerk();
                } else if (attempts >= maxAttempts) {
                    clearInterval(interval);
                    updateStatus('‚ùå Clerk SDK failed to load', 'error');
                    showFallback();
                } else {
                    updateStatus(`Waiting for Clerk SDK... (${attempts}/${maxAttempts})`);
                }
            }, 500);
        }
        
        // Initialize Clerk WITH custom domain
        async function initializeClerk() {
            try {
                updateStatus('Configuring Clerk with custom domain...');
                
                // IMPORTANT: Must use frontendApi with custom domain
                await Clerk.load({
                    publishableKey: CLERK_PUBLISHABLE_KEY,
                    frontendApi: CLERK_FRONTEND_API
                });
                
                updateStatus('‚úÖ Clerk configured!', 'success');
                
                // Mount sign-up
                Clerk.mountSignUp(document.getElementById('clerk-container'));
                
                updateStatus('‚úÖ Ready for sign up!', 'success');
                
                // Listen for sign-up
                Clerk.addListener(({ user }) => {
                    if (user) {
                        updateStatus('üéâ Account created!', 'success');
                        setTimeout(() => {
                            window.location.href = '/testing/dashboard';
                        }, 1500);
                    }
                });
                
            } catch (error) {
                updateStatus(`‚ùå Clerk error: ${error.message}`, 'error');
                console.error('Clerk error:', error);
                showFallback();
            }
        }
        
        // Fallback authentication
        function showFallback() {
            document.getElementById('clerk-container').innerHTML = `
                <div style="text-align: center; padding: 30px;">
                    <h3 style="color: #ffcc00;">‚ö†Ô∏è Clerk Authentication</h3>
                    <p>Clerk is configured with custom domain: ${CLERK_FRONTEND_API}</p>
                    <p>This domain needs to be accessible.</p>
                    
                    <div style="margin: 20px 0;">
                        <button onclick="useDemoAuth()" style="
                            background: linear-gradient(90deg, #6a0dad, #9d4edd);
                            color: white;
                            border: none;
                            padding: 12px 24px;
                            border-radius: 50px;
                            font-weight: 600;
                            cursor: pointer;
                            margin: 10px;
                        ">
                            Use Demo Account
                        </button>
                        
                        <button onclick="location.reload()" style="
                            background: transparent;
                            color: #9d4edd;
                            border: 2px solid #9d4edd;
                            padding: 12px 24px;
                            border-radius: 50px;
                            font-weight: 600;
                            cursor: pointer;
                            margin: 10px;
                        ">
                            Retry Clerk
                        </button>
                    </div>
                    
                    <p style="font-size: 0.9rem; color: #aaa;">
                        To fix: Check DNS for ${CLERK_FRONTEND_API.replace('https://', '')}
                    </p>
                </div>
            `;
        }
        
        function useDemoAuth() {
            const email = prompt('Enter email for demo:', 'demo@rumora.com');
            if (email) {
                localStorage.setItem('rumora_demo_user', JSON.stringify({
                    email: email,
                    name: email.split('@')[0],
                    plan: 'Silver',
                    capeCount: 1
                }));
                window.location.href = '/testing/dashboard';
            }
        }
        
        // Start
        document.addEventListener('DOMContentLoaded', waitForClerk);
    </script>
</body>
</html>
